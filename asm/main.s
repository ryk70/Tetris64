;
; File generated by cc65 v 2.17 - Git N/A
;
	.fopt		compiler,"cc65 v 2.17 - Git N/A"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.forceimport	__STARTUP__
	.import		_rand
	.import		__randomize
	.import		_clrscr
	.import		_gotoxy
	.import		_cputcxy
	.import		_cprintf
	.import		_cgetc
	.import		_cursor
	.import		_textcolor
	.import		_bgcolor
	.import		_bordercolor
	.import		_screensize
	.import		_strlen
	.export		_main

.segment	"RODATA"

_Title:
	.byte	$D4,$C5,$D4,$D2,$C9,$D3,$36,$34,$00
_Inst:
	.byte	$D0,$D2,$C5,$D3,$D3,$20,$D8,$20,$D4,$CF,$20,$D0,$CC,$C1,$D9,$00
L0022:
	.byte	$25,$53,$00
L0019	:=	L0022+0

.segment	"BSS"

_xdim:
	.res	1,$00
_ydim:
	.res	1,$00
_i:
	.res	1,$00
_isGameOver:
	.res	1,$00
_linesCleared:
	.res	2,$00
_curTet:
	.res	1,$00
_xTet:
	.res	1,$00
_yTet:
	.res	1,$00
_isPlaced:
	.res	1,$00
_initPlacement:
	.res	1,$00

; ---------------------------------------------------------------
; void __near__ draw_title (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_title: near

.segment	"CODE"

	jsr     _clrscr
	lda     #$00
	jsr     _bgcolor
	lda     #$00
	jsr     _bordercolor
	lda     #$01
	jsr     _textcolor
	lda     _xdim
	jsr     pusha0
	lda     #<(_Title)
	ldx     #>(_Title)
	jsr     _strlen
	jsr     tossubax
	jsr     shrax1
	jsr     pusha
	lda     _ydim
	lsr     a
	sec
	sbc     #$01
	jsr     _gotoxy
	lda     #<(L0019)
	ldx     #>(L0019)
	jsr     pushax
	lda     #<(_Title)
	ldx     #>(_Title)
	jsr     pushax
	ldy     #$04
	jsr     _cprintf
	lda     _xdim
	jsr     pusha0
	lda     #<(_Inst)
	ldx     #>(_Inst)
	jsr     _strlen
	jsr     tossubax
	jsr     shrax1
	jsr     pusha
	lda     _ydim
	lsr     a
	jsr     _gotoxy
	lda     #<(L0022)
	ldx     #>(L0022)
	jsr     pushax
	lda     #<(_Inst)
	ldx     #>(_Inst)
	jsr     pushax
	ldy     #$04
	jmp     _cprintf

.endproc

; ---------------------------------------------------------------
; void __near__ draw_game (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_game: near

.segment	"CODE"

	jsr     _clrscr
	lda     #$01
	sta     _i
	jmp     L00FF
L00FE:	lda     _i
	clc
	adc     #$05
	jsr     pusha
	lda     #$02
	jsr     pusha
	lda     #$EF
	jsr     _cputcxy
	inc     _i
L00FF:	lda     _i
	cmp     #$0B
	bcc     L00FE
	lda     #$01
	sta     _i
	jmp     L0101
L0100:	lda     _i
	clc
	adc     #$05
	jsr     pusha
	lda     #$17
	jsr     pusha
	lda     #$F7
	jsr     _cputcxy
	inc     _i
L0101:	lda     _i
	cmp     #$0B
	bcc     L0100
	lda     #$01
	sta     _i
	jmp     L0102
L003F:	lda     #$05
	jsr     pusha
	lda     _i
	clc
	adc     #$02
	jsr     pusha
	lda     #$EA
	jsr     _cputcxy
	inc     _i
L0102:	lda     _i
	cmp     #$15
	bcc     L003F
	lda     #$01
	sta     _i
	jmp     L0103
L004A:	lda     #$10
	jsr     pusha
	lda     _i
	clc
	adc     #$02
	jsr     pusha
	lda     #$F4
	jsr     _cputcxy
	inc     _i
L0103:	lda     _i
	cmp     #$15
	bcc     L004A
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ pickTet (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_pickTet: near

.segment	"CODE"

	jsr     __randomize
	jsr     _rand
	jsr     pushax
	ldx     #$00
	lda     #$07
	jsr     tosmoda0
	sta     _curTet
	jsr     _rand
	jsr     pushax
	ldx     #$00
	lda     #$07
	jsr     tosmoda0
	clc
	adc     #$06
	sta     _initPlacement
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ drawTet (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_drawTet: near

.segment	"CODE"

	lda     #$A9
	jsr     pusha
	lda     _curTet
	bne     L0104
	lda     #$0E
	jsr     _textcolor
	lda     #$09
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     #$0A
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     #$0B
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     #$0C
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
L0104:	lda     _curTet
	cmp     #$01
	bne     L0105
	lda     #$07
	jsr     _textcolor
	lda     #$0A
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     #$0B
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     #$0A
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     #$0B
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
L0105:	lda     _curTet
	cmp     #$02
	bne     L0106
	lda     #$04
	jsr     _textcolor
	lda     _initPlacement
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$02
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
L0106:	lda     _curTet
	cmp     #$03
	bne     L0107
	lda     #$05
	jsr     _textcolor
	lda     _initPlacement
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$02
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
L0107:	lda     _curTet
	cmp     #$04
	bne     L0108
	lda     #$02
	jsr     _textcolor
	lda     _initPlacement
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$02
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
L0108:	lda     _curTet
	cmp     #$05
	bne     L0109
	lda     #$08
	jsr     _textcolor
	lda     _initPlacement
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$02
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
L0109:	lda     _curTet
	cmp     #$06
	bne     L00D4
	jsr     _textcolor
	lda     _initPlacement
	jsr     pusha
	lda     #$03
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$01
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
	lda     _initPlacement
	clc
	adc     #$02
	jsr     pusha
	lda     #$04
	jsr     pusha
	ldy     #$02
	lda     (sp),y
	jsr     _cputcxy
L00D4:	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; void __near__ game_loop (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_game_loop: near

.segment	"CODE"

	jmp     L00EC
L00EA:	jsr     _pickTet
	jsr     _drawTet
L00EC:	lda     _isGameOver
	cmp     #$01
	bne     L00EA
	rts

.endproc

; ---------------------------------------------------------------
; int __near__ main (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_main: near

.segment	"CODE"

	lda     #$00
	jsr     _cursor
	lda     #<(_xdim)
	ldx     #>(_xdim)
	jsr     pushax
	lda     #<(_ydim)
	ldx     #>(_ydim)
	jsr     _screensize
	jsr     _draw_title
L00F7:	jsr     _cgetc
	cmp     #$58
	bne     L00F7
	jsr     _draw_game
	jsr     _game_loop
	ldx     #$00
	txa
	rts

.endproc

